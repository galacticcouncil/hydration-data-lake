module.exports = class Data1734971511231 {
    name = 'Data1734971511231'

    async up(db) {
        await db.query(`CREATE TABLE "account_chain_activity_trace" ("id" character varying NOT NULL, "account_id" character varying, "chain_activity_trace_id" character varying, CONSTRAINT "PK_e832c7a98d7de349b5fccc0c34e" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_d192e6637a761ef190582d0355" ON "account_chain_activity_trace" ("account_id") `)
        await db.query(`CREATE INDEX "IDX_b759ef6840440664835e4890fe" ON "account_chain_activity_trace" ("chain_activity_trace_id") `)
        await db.query(`CREATE TABLE "event" ("id" character varying NOT NULL, "trace_id" text NOT NULL, "index_in_block" integer NOT NULL, "name" text NOT NULL, "phase" text NOT NULL, "entity_types" character varying(27) array, "para_chain_block_height" integer NOT NULL, "call_id" character varying, "block_id" character varying, CONSTRAINT "PK_30c2f3bbaf6d34a55f8ae6e4614" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_83cf1bd59aa4521ed882fa5145" ON "event" ("call_id") `)
        await db.query(`CREATE INDEX "IDX_a6ab88a515a37d2f63b13e6990" ON "event" ("para_chain_block_height") `)
        await db.query(`CREATE INDEX "IDX_2b0d35d675c4f99751855c4502" ON "event" ("block_id") `)
        await db.query(`CREATE TABLE "call" ("id" character varying NOT NULL, "trace_id" text NOT NULL, "name" text NOT NULL, "success" boolean, "origin_kind" text NOT NULL, "origin_value_kind" text, "origin_value" text, "entity_types" character varying(27) array, "para_chain_block_height" integer NOT NULL, "extrinsic_id" character varying, "parent_id" character varying, "block_id" character varying, CONSTRAINT "PK_2098af0169792a34f9cfdd39c47" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_dde30e4f2c6a80f9236bfdf259" ON "call" ("extrinsic_id") `)
        await db.query(`CREATE INDEX "IDX_11c1e76d5be8f04c472c4a05b9" ON "call" ("parent_id") `)
        await db.query(`CREATE INDEX "IDX_4d913e3682b51fbec02d220d31" ON "call" ("para_chain_block_height") `)
        await db.query(`CREATE INDEX "IDX_bd3f11fd4110d60ac8b96cd62f" ON "call" ("block_id") `)
        await db.query(`CREATE TABLE "extrinsic" ("id" character varying NOT NULL, "hash" text NOT NULL, "para_chain_block_height" integer NOT NULL, "block_id" character varying, CONSTRAINT "PK_80d7db0e4b1e83e30336bc76755" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_0aabe6821dd297c4d089e10ee2" ON "extrinsic" ("para_chain_block_height") `)
        await db.query(`CREATE INDEX "IDX_a3b99daba1259dab0dd040d4f7" ON "extrinsic" ("block_id") `)
        await db.query(`CREATE TABLE "block" ("id" character varying NOT NULL, "relay_chain_block_height" integer NOT NULL, "para_chain_block_height" integer NOT NULL, "para_chain_block_hash" text NOT NULL, "para_chain_block_timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, CONSTRAINT "PK_d0925763efb591c2e2ffb267572" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_2985eaf5af08501e0cf329e860" ON "block" ("para_chain_block_height") `)
        await db.query(`CREATE INDEX "IDX_2ba86968a4587d92115b6a2312" ON "block" ("para_chain_block_hash") `)
        await db.query(`CREATE INDEX "IDX_87351efaeda43445ba7df534fe" ON "block" ("para_chain_block_timestamp") `)
        await db.query(`CREATE TABLE "chain_activity_trace" ("id" character varying NOT NULL, "operation_ids" text array, "trace_ids" text array NOT NULL, "created_at_para_chain_block_height" integer NOT NULL, "originator_id" character varying, "root_trace_id" character varying, "created_at_block_id" character varying, CONSTRAINT "PK_164702284b0a05ee17e51017525" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_d665d031ccf880084aeef8290a" ON "chain_activity_trace" ("originator_id") `)
        await db.query(`CREATE INDEX "IDX_26c2eb8e87337934308e440e2d" ON "chain_activity_trace" ("root_trace_id") `)
        await db.query(`CREATE INDEX "IDX_2d4945fe7fc64351993ee410a1" ON "chain_activity_trace" ("created_at_para_chain_block_height") `)
        await db.query(`CREATE INDEX "IDX_3f3b01d8c3b64580481eed5cf8" ON "chain_activity_trace" ("created_at_block_id") `)
        await db.query(`ALTER TABLE "swap" ADD "operation_id" text`)
        await db.query(`ALTER TABLE "swap" ADD "trace_ids" text array`)
        await db.query(`ALTER TABLE "transfer" ADD "trace_ids" text array`)
        await db.query(`ALTER TABLE "stablepool_liquidity_action" ADD "trace_ids" text array`)
        await db.query(`ALTER TABLE "account_chain_activity_trace" ADD CONSTRAINT "FK_d192e6637a761ef190582d0355f" FOREIGN KEY ("account_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "account_chain_activity_trace" ADD CONSTRAINT "FK_b759ef6840440664835e4890fee" FOREIGN KEY ("chain_activity_trace_id") REFERENCES "chain_activity_trace"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "event" ADD CONSTRAINT "FK_83cf1bd59aa4521ed882fa51452" FOREIGN KEY ("call_id") REFERENCES "call"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "event" ADD CONSTRAINT "FK_2b0d35d675c4f99751855c45021" FOREIGN KEY ("block_id") REFERENCES "block"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "call" ADD CONSTRAINT "FK_dde30e4f2c6a80f9236bfdf2590" FOREIGN KEY ("extrinsic_id") REFERENCES "extrinsic"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "call" ADD CONSTRAINT "FK_11c1e76d5be8f04c472c4a05b95" FOREIGN KEY ("parent_id") REFERENCES "call"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "call" ADD CONSTRAINT "FK_bd3f11fd4110d60ac8b96cd62f3" FOREIGN KEY ("block_id") REFERENCES "block"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "extrinsic" ADD CONSTRAINT "FK_a3b99daba1259dab0dd040d4f74" FOREIGN KEY ("block_id") REFERENCES "block"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "chain_activity_trace" ADD CONSTRAINT "FK_d665d031ccf880084aeef8290a5" FOREIGN KEY ("originator_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "chain_activity_trace" ADD CONSTRAINT "FK_26c2eb8e87337934308e440e2de" FOREIGN KEY ("root_trace_id") REFERENCES "chain_activity_trace"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "chain_activity_trace" ADD CONSTRAINT "FK_3f3b01d8c3b64580481eed5cf87" FOREIGN KEY ("created_at_block_id") REFERENCES "block"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "account_chain_activity_trace"`)
        await db.query(`DROP INDEX "public"."IDX_d192e6637a761ef190582d0355"`)
        await db.query(`DROP INDEX "public"."IDX_b759ef6840440664835e4890fe"`)
        await db.query(`DROP TABLE "event"`)
        await db.query(`DROP INDEX "public"."IDX_83cf1bd59aa4521ed882fa5145"`)
        await db.query(`DROP INDEX "public"."IDX_a6ab88a515a37d2f63b13e6990"`)
        await db.query(`DROP INDEX "public"."IDX_2b0d35d675c4f99751855c4502"`)
        await db.query(`DROP TABLE "call"`)
        await db.query(`DROP INDEX "public"."IDX_dde30e4f2c6a80f9236bfdf259"`)
        await db.query(`DROP INDEX "public"."IDX_11c1e76d5be8f04c472c4a05b9"`)
        await db.query(`DROP INDEX "public"."IDX_4d913e3682b51fbec02d220d31"`)
        await db.query(`DROP INDEX "public"."IDX_bd3f11fd4110d60ac8b96cd62f"`)
        await db.query(`DROP TABLE "extrinsic"`)
        await db.query(`DROP INDEX "public"."IDX_0aabe6821dd297c4d089e10ee2"`)
        await db.query(`DROP INDEX "public"."IDX_a3b99daba1259dab0dd040d4f7"`)
        await db.query(`DROP TABLE "block"`)
        await db.query(`DROP INDEX "public"."IDX_2985eaf5af08501e0cf329e860"`)
        await db.query(`DROP INDEX "public"."IDX_2ba86968a4587d92115b6a2312"`)
        await db.query(`DROP INDEX "public"."IDX_87351efaeda43445ba7df534fe"`)
        await db.query(`DROP TABLE "chain_activity_trace"`)
        await db.query(`DROP INDEX "public"."IDX_d665d031ccf880084aeef8290a"`)
        await db.query(`DROP INDEX "public"."IDX_26c2eb8e87337934308e440e2d"`)
        await db.query(`DROP INDEX "public"."IDX_2d4945fe7fc64351993ee410a1"`)
        await db.query(`DROP INDEX "public"."IDX_3f3b01d8c3b64580481eed5cf8"`)
        await db.query(`ALTER TABLE "swap" DROP COLUMN "operation_id"`)
        await db.query(`ALTER TABLE "swap" DROP COLUMN "trace_ids"`)
        await db.query(`ALTER TABLE "transfer" DROP COLUMN "trace_ids"`)
        await db.query(`ALTER TABLE "stablepool_liquidity_action" DROP COLUMN "trace_ids"`)
        await db.query(`ALTER TABLE "account_chain_activity_trace" DROP CONSTRAINT "FK_d192e6637a761ef190582d0355f"`)
        await db.query(`ALTER TABLE "account_chain_activity_trace" DROP CONSTRAINT "FK_b759ef6840440664835e4890fee"`)
        await db.query(`ALTER TABLE "event" DROP CONSTRAINT "FK_83cf1bd59aa4521ed882fa51452"`)
        await db.query(`ALTER TABLE "event" DROP CONSTRAINT "FK_2b0d35d675c4f99751855c45021"`)
        await db.query(`ALTER TABLE "call" DROP CONSTRAINT "FK_dde30e4f2c6a80f9236bfdf2590"`)
        await db.query(`ALTER TABLE "call" DROP CONSTRAINT "FK_11c1e76d5be8f04c472c4a05b95"`)
        await db.query(`ALTER TABLE "call" DROP CONSTRAINT "FK_bd3f11fd4110d60ac8b96cd62f3"`)
        await db.query(`ALTER TABLE "extrinsic" DROP CONSTRAINT "FK_a3b99daba1259dab0dd040d4f74"`)
        await db.query(`ALTER TABLE "chain_activity_trace" DROP CONSTRAINT "FK_d665d031ccf880084aeef8290a5"`)
        await db.query(`ALTER TABLE "chain_activity_trace" DROP CONSTRAINT "FK_26c2eb8e87337934308e440e2de"`)
        await db.query(`ALTER TABLE "chain_activity_trace" DROP CONSTRAINT "FK_3f3b01d8c3b64580481eed5cf87"`)
    }
}
