module.exports = class Data1735324352739 {
    name = 'Data1735324352739'

    async up(db) {
        await db.query(`DROP INDEX "public"."IDX_2931a0595b42e0c36085dc3cd0"`)
        await db.query(`CREATE TABLE "otc_order" ("id" character varying NOT NULL, "operation_id" text, "trace_ids" text array, "amount_out" numeric NOT NULL, "amount_in" numeric NOT NULL, "partially_fillable" boolean, "status" character varying(8), "created_at_relay_block_height" integer NOT NULL, "created_at_para_block_height" integer NOT NULL, "owner_id" character varying, "asset_in_id" character varying, "asset_out_id" character varying, CONSTRAINT "PK_62f22d282db637808ecfae04b64" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_361786e76b68398680313ff32c" ON "otc_order" ("owner_id") `)
        await db.query(`CREATE INDEX "IDX_944b7b08b3499484f282f1072b" ON "otc_order" ("asset_in_id") `)
        await db.query(`CREATE INDEX "IDX_870e593710669cdd8062a11824" ON "otc_order" ("asset_out_id") `)
        await db.query(`CREATE INDEX "IDX_7329c1f404d46516062d62a6ea" ON "otc_order" ("status") `)
        await db.query(`CREATE INDEX "IDX_d82089a1c0780a60c497f21668" ON "otc_order" ("created_at_para_block_height") `)
        await db.query(`CREATE TABLE "otc_order_action" ("id" character varying NOT NULL, "operation_id" text, "trace_ids" text array, "amount_in" numeric, "amount_out" numeric, "fee" numeric, "status" character varying(16), "event_index" integer NOT NULL, "relay_chain_block_height" integer NOT NULL, "para_chain_block_height" integer NOT NULL, "order_id" character varying, "swap_id" character varying, CONSTRAINT "PK_39e0d4b508fcc10be06f60a2267" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_e3f4653f384f23e8190ec13e4c" ON "otc_order_action" ("operation_id") `)
        await db.query(`CREATE INDEX "IDX_2ed462a41c8e7e01968ff656b8" ON "otc_order_action" ("order_id") `)
        await db.query(`CREATE INDEX "IDX_60b3be7a7f33092b638316e029" ON "otc_order_action" ("status") `)
        await db.query(`CREATE INDEX "IDX_26844241b5e1d818cbf30a4230" ON "otc_order_action" ("swap_id") `)
        await db.query(`CREATE INDEX "IDX_314ce5a6fafc9237a035ff5b9b" ON "otc_order_action" ("para_chain_block_height") `)
        await db.query(`ALTER TABLE "dca_schedule" DROP COLUMN "relay_chain_block_height"`)
        await db.query(`ALTER TABLE "dca_schedule" DROP COLUMN "para_chain_block_height"`)
        await db.query(`ALTER TABLE "dca_schedule" ADD "created_at_relay_block_height" integer NOT NULL`)
        await db.query(`ALTER TABLE "dca_schedule" ADD "created_at_para_block_height" integer NOT NULL`)
        await db.query(`ALTER TABLE "swap" ADD "otc_order_fulfilment_id" character varying`)
        await db.query(`CREATE INDEX "IDX_4f4d890eb9f6d878b03594dada" ON "dca_schedule" ("created_at_para_block_height") `)
        await db.query(`CREATE INDEX "IDX_e5f45bd0ba6846f0bbc877d682" ON "swap" ("otc_order_fulfilment_id") `)
        await db.query(`ALTER TABLE "otc_order" ADD CONSTRAINT "FK_361786e76b68398680313ff32c5" FOREIGN KEY ("owner_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "otc_order" ADD CONSTRAINT "FK_944b7b08b3499484f282f1072b5" FOREIGN KEY ("asset_in_id") REFERENCES "asset"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "otc_order" ADD CONSTRAINT "FK_870e593710669cdd8062a118245" FOREIGN KEY ("asset_out_id") REFERENCES "asset"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "otc_order_action" ADD CONSTRAINT "FK_2ed462a41c8e7e01968ff656b83" FOREIGN KEY ("order_id") REFERENCES "otc_order"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "otc_order_action" ADD CONSTRAINT "FK_26844241b5e1d818cbf30a4230c" FOREIGN KEY ("swap_id") REFERENCES "swap"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "swap" ADD CONSTRAINT "FK_e5f45bd0ba6846f0bbc877d6820" FOREIGN KEY ("otc_order_fulfilment_id") REFERENCES "otc_order_action"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`CREATE INDEX "IDX_2931a0595b42e0c36085dc3cd0" ON "dca_schedule" ("para_chain_block_height") `)
        await db.query(`DROP TABLE "otc_order"`)
        await db.query(`DROP INDEX "public"."IDX_361786e76b68398680313ff32c"`)
        await db.query(`DROP INDEX "public"."IDX_944b7b08b3499484f282f1072b"`)
        await db.query(`DROP INDEX "public"."IDX_870e593710669cdd8062a11824"`)
        await db.query(`DROP INDEX "public"."IDX_7329c1f404d46516062d62a6ea"`)
        await db.query(`DROP INDEX "public"."IDX_d82089a1c0780a60c497f21668"`)
        await db.query(`DROP TABLE "otc_order_action"`)
        await db.query(`DROP INDEX "public"."IDX_e3f4653f384f23e8190ec13e4c"`)
        await db.query(`DROP INDEX "public"."IDX_2ed462a41c8e7e01968ff656b8"`)
        await db.query(`DROP INDEX "public"."IDX_60b3be7a7f33092b638316e029"`)
        await db.query(`DROP INDEX "public"."IDX_26844241b5e1d818cbf30a4230"`)
        await db.query(`DROP INDEX "public"."IDX_314ce5a6fafc9237a035ff5b9b"`)
        await db.query(`ALTER TABLE "dca_schedule" ADD "relay_chain_block_height" integer NOT NULL`)
        await db.query(`ALTER TABLE "dca_schedule" ADD "para_chain_block_height" integer NOT NULL`)
        await db.query(`ALTER TABLE "dca_schedule" DROP COLUMN "created_at_relay_block_height"`)
        await db.query(`ALTER TABLE "dca_schedule" DROP COLUMN "created_at_para_block_height"`)
        await db.query(`ALTER TABLE "swap" DROP COLUMN "otc_order_fulfilment_id"`)
        await db.query(`DROP INDEX "public"."IDX_4f4d890eb9f6d878b03594dada"`)
        await db.query(`DROP INDEX "public"."IDX_e5f45bd0ba6846f0bbc877d682"`)
        await db.query(`ALTER TABLE "otc_order" DROP CONSTRAINT "FK_361786e76b68398680313ff32c5"`)
        await db.query(`ALTER TABLE "otc_order" DROP CONSTRAINT "FK_944b7b08b3499484f282f1072b5"`)
        await db.query(`ALTER TABLE "otc_order" DROP CONSTRAINT "FK_870e593710669cdd8062a118245"`)
        await db.query(`ALTER TABLE "otc_order_action" DROP CONSTRAINT "FK_2ed462a41c8e7e01968ff656b83"`)
        await db.query(`ALTER TABLE "otc_order_action" DROP CONSTRAINT "FK_26844241b5e1d818cbf30a4230c"`)
        await db.query(`ALTER TABLE "swap" DROP CONSTRAINT "FK_e5f45bd0ba6846f0bbc877d6820"`)
    }
}
